<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg">
        <div class="card-header text-white" style="background: linear-gradient(135deg, <%= booking_status_color(@booking.status) %> 0%, #6c757d 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h2 class="mb-0">
              <i class="fas fa-ticket-alt me-2"></i>تفاصيل الحجز #<%= @booking.id %>
            </h2>
            <span class="badge bg-light text-dark fs-6">
              <%= booking_status_text(@booking.status) %>
            </span>
          </div>
        </div>

        <div class="card-body">
          <!-- معلومات الرحلة -->
          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card mb-3">
                <div class="card-header bg-primary text-white">
                  <h5 class="mb-0">
                    <i class="fas fa-route me-2"></i>معلومات الرحلة
                  </h5>
                </div>
                <div class="card-body">
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-map-marker-alt text-primary me-2"></i>
                    <span><strong>من:</strong> <%= @booking.ride.from_city %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-map-marker text-primary me-2"></i>
                    <span><strong>إلى:</strong> <%= @booking.ride.to_city %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-calendar-alt text-primary me-2"></i>
                    <span><%= @booking.ride.departure_time.strftime("%Y/%m/%d") %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-clock text-primary me-2"></i>
                    <span><%= @booking.ride.departure_time.strftime("%H:%M") %></span>
                  </div>
                  <div class="d-flex align-items-center">
                    <i class="fas fa-money-bill-wave text-primary me-2"></i>
                    <span><strong>سعر المقعد:</strong> <%= number_to_currency(@booking.ride.price, unit: "ل.س", precision: 0) %></span>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="card mb-3">
                <div class="card-header bg-success text-white">
                  <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>معلومات الحجز
                  </h5>
                </div>
                <div class="card-body">
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-users text-success me-2"></i>
                    <span><strong>عدد المقاعد:</strong> <%= @booking.seats %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-money-bill-wave text-success me-2"></i>
                    <span><strong>السعر الإجمالي:</strong> <%= number_to_currency(@booking.seats * @booking.ride.price, unit: "ل.س", precision: 0) %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-calendar-plus text-success me-2"></i>
                    <span><strong>تاريخ الحجز:</strong> <%= @booking.created_at.strftime("%Y/%m/%d %H:%M") %></span>
                  </div>
                  <div class="d-flex align-items-center">
                    <i class="fas fa-sync-alt text-success me-2"></i>
                    <span><strong>آخر تحديث:</strong> <%= @booking.updated_at.strftime("%Y/%m/%d %H:%M") %></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- معلومات الأشخاص -->
          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card">
                <div class="card-header bg-info text-white">
                  <h5 class="mb-0">
                    <i class="fas fa-user me-2"></i>معلومات السائق
                  </h5>
                </div>
                <div class="card-body">
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-user-circle text-info me-2"></i>
                    <span><strong>الاسم:</strong> <%= @booking.ride.driver.name %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-phone text-info me-2"></i>
                    <span><strong>الهاتف:</strong> <%= @booking.ride.driver.phone %></span>
                  </div>
                  <div class="d-flex align-items-center">
                    <i class="fas fa-envelope text-info me-2"></i>
                    <span><strong>البريد:</strong> <%= @booking.ride.driver.email %></span>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="card">
                <div class="card-header bg-warning text-dark">
                  <h5 class="mb-0" style="color: white">
                    <i class="fas fa-users me-2"></i>معلومات الراكب
                  </h5>
                </div>
                <div class="card-body">
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-user-circle text-warning me-2"></i>
                    <span><strong>الاسم:</strong> <%= @booking.passenger.name %></span>
                  </div>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-phone text-warning me-2"></i>
                    <span><strong>الهاتف:</strong> <%= @booking.passenger.phone %></span>
                  </div>
                  <div class="d-flex align-items-center">
                    <i class="fas fa-envelope text-warning me-2"></i>
                    <span><strong>البريد:</strong> <%= @booking.passenger.email %></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ملاحظات -->
          <% if @booking.notes.present? %>
            <div class="card mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-sticky-note me-2"></i>ملاحظات إضافية
                </h5>
              </div>
              <div class="card-body">
                <p class="card-text"><%= @booking.notes %></p>
              </div>
            </div>
          <% end %>

          <!-- أزرار التحكم -->
          <div class="d-flex gap-2 flex-wrap justify-content-center">
            <%= link_to 'العودة إلى الحجوزات', bookings_path, class: 'btn btn-secondary' %>
            <%= link_to 'عرض الرحلة', ride_path(@booking.ride), class: 'btn btn-outline-primary' %>

            <% if current_user == @booking.passenger && @booking.pending? %>
              <%= button_to 'إلغاء الحجز', booking_path(@booking), method: :delete,
                  data: { confirm: 'هل أنت متأكد من إلغاء هذا الحجز؟' },
                  class: 'btn btn-danger' %>
            <% end %>

            <% if current_user == @booking.ride.driver && @booking.pending? %>
              <%= button_to 'قبول الحجز', confirm_booking_path(@booking), method: :post,
                  class: 'btn btn-success' %>
              <%= button_to 'رفض الحجز', reject_booking_path(@booking), method: :post,
                  class: 'btn btn-warning' %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.card {
  border-radius: 15px;
  overflow: hidden;
}

.card-header {
  border-radius: 15px 15px 0 0 !important;
}

.btn {
  border-radius: 10px;
  padding: 0.6rem 1.5rem;
}
</style>
